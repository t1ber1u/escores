import { generate as generateTOTPToken } from 'totp-generator';

export interface TotpOptions {
  digits?: number;
  period?: number;
  algorithm?: 'SHA-1' | 'SHA-256' | 'SHA-512';
  timestamp?: number;
}

export class TotpService {
  private secret: string;

  constructor(secret: string) {
    this.secret = secret;
  }

  public generateToken(options: TotpOptions = {}): string {
    return generateTOTPToken(this.secret, options);
  }
}